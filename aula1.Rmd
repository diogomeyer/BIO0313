---
title: "Biologia Evolutiva (BIO 0313)"
author: "Diogo Meyer"
date: "2/26/2019"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_float: yes
  pdf_document:
    number_sections: yes
    toc: yes
---

# Deriva, teoria neutra e tamanho efetivo populacional

Neste documento retomo alguns conceitos que serão fundamentais no restante do curso. Para cada conceito, apresento perguntas que devem ser discutidas em grupo.Leia e tente responder às questões.


## O que é deriva genética?

1. Para começar, defina em suas próprias palavras o que é a deriva genética, e quais seus efeitos sobre a diversidade genética dentro de populações, assim como sobre as diferenças entre populações.

2. Uma forma de se compreender deriva genética é pensar quais seriam as condições necessárias para que ela _não ocorresse_. Uma dessas condições seria o caso de uma população de tamanho infinito. Agora considere um segundo cenário possível, bastante extremo mas bem interessante. Imagine uma população tivesse $N$ indivíduos diploides, sendo exatamente metade deles machos e metade fêmeas, formando $N/2$ casais. Imagine que todos esses casais tenham _exatamente_ dois filhos, e que após o nascimento dos filhos os pais morressem (tornando esse um modelo de "gerações discretas"). Esse cenário garante a ausência de deriva genética? 

3. Imagine que você está estudando uma espécie de peixe que habita um lago, como as trutas descritas por Hedrick no capítulo indicado. Suponha que ao sequenciar um gene, você descobre que todos indivíduos são geneticamente idênticos. Um colega sugere que houve seleção atuando sobre aquele gene, que fixou uma versão favorável em todos indivíduos. Como distinguir entre essa hipótese seletiva e a alternativa, que é a de que essa espécie sofreu deriva genética intensa, assim explicando a baixa variação naquele gene?

## Probabilidade de fixação de uma mutação

Um importante resultado da teoria neutra é que, num modelo apenas com deriva, a chance de uma mutação se fixar depende apenas de sua frequência na população. Tente justificar esse resultado.

Assumindo esse achado, mutações recém surgidas em populações grandes seriam mais "raras", e teriam menos chances de se fixar do que quando ocorrem em populações pequenas. A previsão seria então a de que as taxas de evolução (dada pela taxa com que mutações surgem e se fixam) deveriam ser maior em populações pequenas (pois as mutações recém surgidas tem uma chance maior de se fixar). Esse raciocínio está correto? Como a sua resposta influencia o desenvolvimento de testes sobre a validade da teoria neutra na natureza?

## Taxa de heterozigose e sua dinâmica

A taxa de heterozigose é a principal medida da diversidade genética numa população. Para um lócus bialélico, ela pode ser definida da seguinte forma:

$$H = 2 f_A (1 - f_A) $$

Onde $f_A$ é a frequência do alelo $A$. O valor de $H$ pode ser interpretado como a probabilidade de amostrar dois alelos da população e eles serem diferentes entre si. 

A dinâmica temporal da mudança de $H$ sob deriva é dada por:

$$H_{t+1} = H_t (1 - \frac{1}{2N})$$

Essa expressão deixa claro que, quanto menor o valor de N, maior será a redução de diversidade genética numa  população.

A perda de diversidade por deriva genética de uma geração para outra, definida por  dada por
$\Delta{_N}H= H_{t+1} - H_t$ é:

$$\Delta{_N}H  = -\frac{H}{2N}$$

(O subscrito N ao lado do $\Delta$ serve para indicar que essa é a mudança em $H$ resultante da ação da deriva, que é uma função do tamanho populacional, simbolizado por $N$.)

Se a deriva fosse o único processo ocorrendo, o resultado seria a perda completa de variação numa população. Entretanto, o processo de mutação introduz variabilidade genética nas populações. Uma forma quantitativa de expressar esse processo é através da fórmula para a taxa de heterozigose de uma geração em função da anterior, numa população em que o único processo é o de mutação:

$$H_{t+1} = H_t + (1-H)2\mu$$

Dessa expressão podemos também tirar a mudança entre gerações:

$$\Delta_{\mu}H = (1-H)2 \mu$$ 

(Tente desenvolver sua intuição sobre essas fórmulas, e discuta os pressupostos associados.)

Para quais valores de H a mudança causada por deriva será mais intensa? E para quais valores de H a mudança causada por mutação será mais intensa? 

Vamos agora investigar como se comporta uma população em que esses dois processos estão operando simultaneamente. Uma forma de estudar isso é modelar o efeito conjunto desses dois fatores. Para isso, vamos à expressão para a mudança de H entre gerações, que contempla os efeitos de deriva e seleção:

$$ H_{t+1} = H_t - \frac{H_t}{2N} + (1-H_t)2 \mu $$ 

Pode-se também usar fórmula para a diferença de H entre duas gerações:

$$\Delta H  = -\frac{H}{2N} + (1-H)2 \mu$$

Use um programa de planilhas (ou outra linguagem de programação, se preferir) para ilustrar a trajetória temporal da diversidade genética de uma população com os seguintes parâmetros: 

$N=500; \mu = 10^{-3}$; $H$ inicial $H=0.3$
$N=500; \mu = 10^{-3}$; $H$ inicial $H=0.8$

Faça uma simulação para um período total de 1500 gerações.

Se você souber usar R (implementando, por exemplo, no Rstudio), pode usar o seguinte código:

```
# Função para calcular como H muda ao longo do tempo

# Função que calcula mudança de H entre duas gerações
H.prime <- function(H, N, u) { H - H/(2*N) + (1-H)*2*u}

# Função que calcula H de equilíbrio
H.eq <- function(N, u) {4*N*u / (4*N*u + 1)}

res <- vector(); 
t <- 1500 # número de gerações
res[1] <- 0.2 # H inicial
N <- 500 # Tamanho da população
u <- 10^-3 # Taxa de mutação

# Mostrar trajetória
for(i in 2:t) {res[i] <- H.prime(res[i-1], N, u)}
plot(res)
abline(h=H.eq(N, u))

```

Repare que a trajetória de $H$ tende a se estabilizar após um tempo. Isso ocorre quando atinge-se um valor de $H$ para o qual o ganho de diversidade por mutação é exatamente equilibrado pela sua perda por deriva. Esse valor é chamado de *taxa de heterozigose de equilíbrio* ($H_{eq}$).

Para calcular $H_{eq}$ temos que achar o valor em que os efeitos de mutação e deriva tem a mesma magnitude, ou seja:


 $$(1-H)2 \mu  -\frac{H}{2N} = 0 $$
Mostre que essa expressão pode ser resolvida para chegarmos a:

$$ H_{eq} = \frac{4N\mu}{1 + 4N\mu} $$

## Tamanho efetivo populacional

A intensidade da deriva genética depende do tamanho efetivo populacional. Relembre o conceito de tamanho efetivo, e explique quais fatores podem levá-lo a ser diferente do tamanho de censo de uma população.  

O texto descreve uma situação em que o tamanho efetivo pode ser *maior* do que o tamanho de censo. Comente sobre esse cenário.

Considere três populações (A, B, C). Calcule o tamanho efetivo de cada uma delas. Você acha que é preciso dizer que elas são todas "equivalentes" do ponto de vista genético?

![Populações com diferentes histórias demográficas. Em (A) a população mantém tamanho constante de 1818 indivíduos. Em (B) a população alterna fases de tamanho N=10,000 com outras, de igual duração, de  N=1,000. Em (C) alternam-se fases de N=5,000 e N=1,110. ](figs/gargalos.png)


## Gargalos genéticos

Gargalos genéticos são períodos em que o tamanho de uma população é drasticamente reduzido, dessa forma intensificando o processo de deriva genética. Para entendermos como a ocorrência de gargalos impacta a diversidade genética, vamos recorrer à mesma simulação usada acima. Para visualizar o efeito de gargalos sobre a trajetória temporal da diversidade genética, faça com que em dois ou três momentos (ao longo das 1500 gerações) o tamanho populacional seja reduzido para N=5 por uma geração. Qual o impacto desses gargalos sobre a diversidade genética?

Baseado nesses resultados e em seu conhecimento sobre como diferentes espécies oscilam de tamanho ao longo do tempo, você acha que o tamanho efetivo de uma espécie, estimado a partir de dados genéticos, é um bom preditor de características da espécie que determinam seu tamanho populacional a longo prazo (tais como sua fecundidade)? Ou será que é mais informativo sobre a ocorrência de eventos demográficos (como gargalos)?


## Deriva e teoria da coalescência

https://phytools.shinyapps.io/coalescent-plot/

Varie N, mantendo a simulação fixa em 20 gerações. Observe o efeito. Intui-se a relação entre o tempo até a coalescência de todas as amostras e o tamanho da população. Vamos explorar mais essa simulação na próxima aula.

# Seleção Natural e sua interação com deriva

## Deriva e teoria da coalescência

Antes de embarcar na discussão da seleção, vamos visualizar o processo de deriva sob outra ótica. A simulação abaixo gera gráficos em que a população evoluiu de acordo com um modelo Wright-Fisher, e as linhas de transmissão entre gerações são mostradas. 

https://phytools.shinyapps.io/coalescent-plot/

Use esse simulador para desenvolver uma intuição qualitativa sobre a relação entre o tamanho populacional ($N$) e o tempo necessário para que todas as amostras no momento atual (última fileira embaixo) sejam descendentes de um único ancestral comum que viveu no passado. 

Para uma população de tamanho N=20, faça uma série de simulações em que um dos alelos na população original tenha se fixado, e registre o tempo necessário para isso. Em média, quantas gerações foram necessárias?



## Modelo determinístico de seleção natural

No texto "Theory of selection in populations", Kent Holsinger revisa o conceito básico de seleção natural e apresenta uma fórmula que prevê como a frequência de um alelo (dada por $p$) numa geração difere daquela da geração anterior, supondo que a seleção esteja ocorrendo. 

Usando a fórmula (1) apresentada no texto e um programa de planilhas (ou uma linguagem de programação como R), mostre como uma mutação vantajosa aumenta de frequência ao longo do tempo (decida o número de gerações necessário para ilustrar o processo do modo mais claro). Vamos supor que o coeficiente de seleção associado à mutação seja de 0,05 (ou seja, s=0,05). Com esse valor é possível calcular o valor adaptativo de cada genótipo. Suponha que a frequência inicial da mutação é de 1% e faça seus cálculos para dois cenários, dados abaixo em (a) e (b).

(a) A mutação é vantajosa e recessiva (a vantagem só se faz presente quando duas cópias da mutação estão presentes, ou seja $W_{AA}$ > $W_{Aa}$ e $W_{AA} > W_{aa}$)

(b) A mutação é vantajosa e dominante (indivíduos heterozigotos para a mutação têm o mesmo valor adaptativo, ou seja $W_{AA} = W_{Aa}$, e ambos são maiores que $W_{aa}$)

## Modelo de seleção que incorpora deriva

Para contrastar o modelo determinístico de seleção natural com um que contempla tanto os efeitos de deriva e seleção, use um simulador escrito em R, disponível no seguinte site:

https://phytools.shinyapps.io/drift-selection/

Faça simulações para valores adaptativos de $W_{AA}=1,00; W_{Aa}=0,95; W_{aa}=0,90$, com frequência inicial do alelo em 0,05. Varie o tamanho da população e discuta o efeito sobre as trajetórias e as probabilidades de fixação da mutação vantajosa. O que acontece se você reduz a frequência inicial do alelo vantajoso para 0,01? De modo geral, a partir de quais combinações de tamanho populacional e intensidade de seleção os afeitos estocásticos (introduzidos pela deriva) passam a dominar?

## Probabilidade de fixação sob seleção e deriva genética

Os padrões gerais vistos no exercício anterior foram investigados de modo analítico por J.B.S. Haldane (1982-1964) Motoo Kimura (1924-1994). Eles descobriram que a probabilidade de fixação de uma mutação vantajosa depende da intensidade de seleção que a favorece e também de sua frequência inicial. No caso especial em que a frequência inicial da mutação é $1/2N$ (o que equivale a dizer que ela está presente em uma só cópia, pois é "recém surgida", a fórmula é:

$P= \frac{1 - e^{-2s}}{1 - e^{-4Ns}}$ que para valores de $s$ relativamente baixos e $N$ elevado se aproxima de $2s$.

De posse desse resultado, considere uma mutação presente em uma única cópia, que ocorre numa população de tamanho N=1000. Contraste as probabilidades de fixação de mutações de dois tipos:

- uma mutação neutra;
- uma mutação que confira uma vantagem de 1% (ou seja s=0,01). 

Essa diferença faz sentido para você? Como a probabilidade de fixação no caso de seleção constrasta com o que vimos no modelo determinístico (em que não há deriva)?

Agora imagine que essa mesma mutação vantajosa tivesse surgido numa população de tamanho N=50. Sua previsão para a diferença na probabilidade de fixação entre a mutação neutra e a vantajosa mudaria?

## Usando simulações para testar a teoria

Os resultados anteriores, referentes à probabilidade de fixação, podem ser testados usando simulações. Aliás, é uma prática comum em estudos de genética de populações comparar resultados teóricos com os simulados. Essa abordagem é poderosa, pois caso a teoria seja nova, obter os mesmos resultados que aqueles aqueles da simulação mostra que a teoria está funcionando. Por outro lado se o simulador é novo e a teoria já estabelecida, obter o mesmo resultado indica que o simulador foi programado corretamente.

Utilize o simulador indicado no exercício anterior para ver se a predição teórica é de fato observada. Lembre de ajustar a frequência inicial do alelo para $1/2N$, que corresponde à condição de haver apenas uma cópia do alelo presente na população. Para facilitar o exercício, simule casos em que $s=0,05$ com um tamanho populacional de N=100. Para cada réplica incluam um numero elevado de populações (por exemplo, 100) e registre o número que se fixou. Compare com o valor teórico esperado.

## Tempo até fixação

Outro importante resultado teórico referente à trajetória de mutações diz respeito ao tempo médio que demora para uma mutação surgir e se fixar. Para uma mutação neutra o tempo médio até a fixação é $4N$ gerações. Já para mutações sob seleção, o tempo médio é dado por: $t_{fix} = \frac{2ln(2N_e)}{s}$, onde o $ln$ refere-se ao logaritmo na base natural.

Utilizando essas expressões, compare o tempo médio até a fixação de uma mutação *neutra* que surge numa população de N=1000 indivíduos com o tempo até a fixação para uma mutação que confere vantagem de 1% (ou seja, s=0,01), também numa população de N=1000. A diferença nesses tempos dá alguma ideia sobre como podemos buscar identificar regiões do genoma que estiveram sob os efeitos de seleção natural? 


## Pressupostos do modelo de seleção.

O modelo de seleção natural que usamos em todas nossas modelagem nesta aula faz uma série de simplificações e assume uma série de pressupostos (isto é, condições que são necessárias para que o modelo possa funcionar). 

Apresente esses pressupostos e avalie se você acha que eles comprometem a utilidade do modelo. Por exemplo, discuta se o modelo assume algo biologicamente inverossímil, de modo que ao aceitar esse pressuposto estamos construindo um modelo que não se aplica a populações reais. Ou se, pelo contrário, os pressupostos são razoáveis para muitas populações que poderemos ter interesse em estudar.






